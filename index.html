<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Placar Fodinha Hortus- Mobile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="estilos.css">
</head>
<body>

  <h1>Placar Fodinha Hortus</h1>

  <!-- CONTROLES INICIAIS -->
  <div class="controls" id="controlesIniciais">

    <button id="fullscreenBtn" class="botao">Tela Cheia</button>
    <button class="botao" onclick="abrirDefinirFrases()">Adicionar frases</button>

    <div class="input-group">
      <label for="pontosIniciais">Pontos iniciais:</label>
      <input type="number" id="pontosIniciais" value="0" min="0" />
    </div>

    <div class="input-group">
      <input type="text" id="nomeJogador" placeholder="Nome do jogador" />
      <button class="botao" onclick="adicionarJogador()">Adicionar</button>
    </div>

    <button class="botao" onclick="definirPontosIniciais()">Definir Pontua√ß√£o Inicial</button>
  </div>
  <div id="modalFrases" class="modaladicionadordefrases">
    <button class="botao botaofechar" onclick="abrirDefinirFrases()">X</button>
    <h1>ADICIONADOR DE FRASES</h1>
    <label>oque voce fala quando a pessoa leva mais do que cantou?</label>
    <input id="fraseMais" type="text">
    <br>
    <label>oque voce fala quando a pessoa leva menos do que cantou?</label>
    <input id="fraseMenos" type="text">
    <br>
    <label>oque voce fala quando a pessoa acerta o que cantou?</label>
    <input id="fraseAcerto" type="text">
    <br>
    <button class="botao" onclick="definirFrases()">Adicionar frases</button>
   
    
   
  </div>

  <!-- BOT√ïES DE RODADA -->
  
  <div class="controls">
    <button class="botao" onclick="comecarRodada()">üé≤ Come√ßar Rodada</button>
    <button class="botao" onclick="finalizarRodada()">‚úÖ Finalizar Rodada</button>
    <!-- Bot√£o Reiniciar -->
    <button class="botao" onclick="reiniciarTudo()">üîÑ Reiniciar Tudo</button>

</div>

  <!-- LISTA DE JOGADORES -->
  <div class="jogadores" id="listaJogadores"></div>

  <script>
  let jogadores = [];
let pontosIniciais = 0;
let rodadaIniciada = false;
let previsoesIniciais = []; // guarda previs√£o original no come√ßo da rodada

// Mensagens de puni√ß√£o e b√¥nus (substitua depois)
const punicoesMais = ['bem feito', 'vai perder'];
const punicoesMenos = ['foi quase pena que √© ruim', 'bem feito'];
const bonuses = ['boa', 'foi sorte', 'sortudo', 'isso ai','jogando desse jeito √© facil', 'arrazou'];

// Carregar dados do localStorage ao iniciar a p√°gina
window.onload = () => {
  const dados = localStorage.getItem('placarFonha');
  const frasesMais = JSON.parse(localStorage.getItem("frasesMais")) || [];
  const frasesMenos = JSON.parse(localStorage.getItem("frasesMenos")) || [];
  const frasesAcerto = JSON.parse(localStorage.getItem("frasesAcerto")) || [];
  if (dados) {
    jogadores = JSON.parse(dados);
    atualizarJogadores();
  }
};

  

function definirFrases() {
  const fraseMais = document.getElementById("fraseMais").value;
  const fraseMenos = document.getElementById("fraseMenos").value;
  const fraseAcerto = document.getElementById("fraseAcerto").value;

  // Adiciona cada frase no array correspondente
  if(fraseMais) punicoesMais.push(fraseMais);
  if(fraseMenos) punicoesMenos.push(fraseMenos);
  if(fraseAcerto) bonuses.push(fraseAcerto);
  // Salva os arrays atualizados no localStorage 
  localStorage.setItem("frasesMais", JSON.stringify(frasesMais));
  localStorage.setItem("frasesMenos", JSON.stringify(frasesMenos));
  localStorage.setItem("frasesAcerto", JSON.stringify(frasesAcerto));
  
}
function abrirDefinirFrases(){
  console.log("foi?")
  const modal = document.getElementById("modalFrases")

  modal.classList.toggle("abrirModalAdicionadorDeFrases")
  modal.classList.toggle("fecharModalAdicionadorDeFrases")
}

function falar(texto) {
  const utterance = new SpeechSynthesisUtterance(texto);
  utterance.lang = 'pt-BR';
  speechSynthesis.speak(utterance);
}

function salvarDados() {
  localStorage.setItem('placarFonha', JSON.stringify(jogadores));
}

function definirPontosIniciais() {
  const valor = parseInt(document.getElementById("pontosIniciais").value) || 0;
  pontosIniciais = valor;
  jogadores.forEach(j => {
    j.pontos = pontosIniciais;
    j.previsao = 0;
  });
  atualizarJogadores();
  salvarDados();
}

function adicionarJogador() {
  const nome = document.getElementById("nomeJogador").value.trim();
  if (!nome) return;

  const novoJogador = {
    nome,
    pontos: pontosIniciais,
    previsao: 0,
    foto: `https://picsum.photos/seed/${encodeURIComponent(nome)}/40/40`
  };

  jogadores.push(novoJogador);
  document.getElementById("nomeJogador").value = "";
  atualizarJogadores();
  salvarDados();
}

// Altera previs√£o + / -
function alterarPrevisao(index, delta) {
  jogadores[index].previsao = Math.max(0, jogadores[index].previsao + delta);
  atualizarJogadores();
  salvarDados();
}

// Atualizar previs√£o via input
function atualizarPrevisao(index, valor) {
  jogadores[index].previsao = Math.max(0, parseInt(valor) || 0);
  atualizarJogadores();
  salvarDados();
}

function excluirJogador(index) {
  jogadores.splice(index, 1);
  atualizarJogadores();
  salvarDados();
}

// Come√ßa a rodada e grava as previs√µes iniciais para comparar depois
function comecarRodada() {
  if (!rodadaIniciada) {
    document.getElementById("controlesIniciais").style.display = "none";
    rodadaIniciada = true;
  }

  previsoesIniciais = jogadores.map(j => j.previsao);

  const texto = jogadores.map(j => `O ${j.nome} leva ${j.previsao}`).join(', ');
  falar(texto + ".");
}

// Finaliza rodada, calcula diferen√ßa entre previs√£o inicial e atual, atualiza pontos e fala mensagens
function finalizarRodada() {
  jogadores.forEach((j, i) => {
    let diff = previsoesIniciais[i] - j.previsao; // diferen√ßa: previsao inicial - previsao atual (resultado real)

    j.pontos -= Math.abs(diff); // desconta a diferen√ßa absoluta do placar

    if (diff > 0) {
      // Levou MENOS do que previu (clicou - no final) ‚Üí puni√ß√£oMenos
      const msgPunicao = punicoesMenos[Math.floor(Math.random() * punicoesMenos.length)];
      falar(` ${j.nome} disse que levava ${previsoesIniciais[i]} e levou ${j.previsao}, agora est√° com ${j.pontos}. ${msgPunicao}`);
    } else if (diff < 0) {
      // Levou MAIS do que previu (clicou + no final) ‚Üí puni√ß√£oMais
      const msgPunicao = punicoesMais[Math.floor(Math.random() * punicoesMais.length)];
      falar(` ${j.nome} disse que levava ${previsoesIniciais[i]} e levou ${j.previsao}, agora est√° com ${j.pontos}. ${msgPunicao}`);
    } else {
      // Acertou exatamente
      const msgBonus = bonuses[Math.floor(Math.random() * bonuses.length)];
      falar(` ${j.nome} acertou e agora est√° com ${j.pontos}! ${msgBonus}`);
    }
  });

  atualizarJogadores();
  salvarDados();
}

function atualizarJogadores() {
  const lista = document.getElementById("listaJogadores");
  lista.innerHTML = "";

  jogadores.forEach((j, i) => {
    const card = document.createElement("div");
    card.className = "jogador-card";

    card.innerHTML = `
      <div class="jogador-info">
        <img src="${j.foto}" alt="foto" />
        <span>${j.nome} <div class="pontosdiv">${j.pontos}</div> pts</span>
      </div>
      <div class="acoes">
      
        <label>Cantada</label>
        <div class="botoesdeacoes">
            <button class="menos" onclick="alterarPrevisao(${i}, -1)">-1</button>
            <input type="number" min="0" value="${j.previsao}" onchange="atualizarPrevisao(${i}, this.value)" />
            <button class="mais" onclick="alterarPrevisao(${i}, 1)">+1</button>
        </div>
        </div>
      <div class="acoes">
        <label>Cantada</label>
        <label></label>
        <span class="pontosdivcantada">${j.previsao}</span>
      </div>
      <div class="acoes botoes-rodada">
        <button class="excluir" onclick="excluirJogador(${i})">üóëÔ∏è</button>
      </div>
    `;

    lista.appendChild(card);
  });
}

// Bot√£o para reiniciar tudo e mostrar formul√°rio de adicionar jogadores
function reiniciarTudo() {
  if (confirm("Tem certeza? Os jogadores e pontos ser√£o apagados!")) {
    jogadores = [];
    pontosIniciais = 0;
    rodadaIniciada = false;
    document.getElementById("controlesIniciais").style.display = "flex"; // mostra o formul√°rio
    atualizarJogadores();
    salvarDados();
  }
}
const fullscreenBtn = document.getElementById('fullscreenBtn');

fullscreenBtn.addEventListener('click', () => {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
    fullscreenBtn.innerText = 'Sair Tela Cheia';
  } else {
    document.exitFullscreen();
    fullscreenBtn.innerText = 'Tela Cheia';
  }
});


  </script>
</body>
</html>
